<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>ResNet - Residual Blocks | Adil&#39;s Notes</title>
<meta name="keywords" content="Deep Learning, Neural Networks, CNN, ResNet">
<meta name="description" content="Dive into ResNet architecture and its innovative residual blocks.">
<meta name="author" content="">
<link rel="canonical" href="https://adilsarsenov.dev/posts/resnet/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.a72801f0f40a8d7f71aa1cafd1c2f2a993a1f26ca1cfd38fdba65d5b9b0f08a0.css" integrity="sha256-pygB8PQKjX9xqhyv0cLyqZOh8myhz9OP26ZdW5sPCKA=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js" integrity="sha256-uVus3DnjejMqn4g7Hni&#43;Srwf3KK8HyZB9V4809q9TWE="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://adilsarsenov.dev/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://adilsarsenov.dev/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://adilsarsenov.dev/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://adilsarsenov.dev/apple-touch-icon.png">
<link rel="mask-icon" href="https://adilsarsenov.dev/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="ResNet - Residual Blocks" />
<meta property="og:description" content="Dive into ResNet architecture and its innovative residual blocks." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://adilsarsenov.dev/posts/resnet/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-03-22T18:34:44&#43;05:00" />
<meta property="article:modified_time" content="2024-03-22T18:34:44&#43;05:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="ResNet - Residual Blocks"/>
<meta name="twitter:description" content="Dive into ResNet architecture and its innovative residual blocks."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://adilsarsenov.dev/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ResNet - Residual Blocks",
      "item": "https://adilsarsenov.dev/posts/resnet/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "ResNet - Residual Blocks",
  "name": "ResNet - Residual Blocks",
  "description": "Dive into ResNet architecture and its innovative residual blocks.",
  "keywords": [
    "Deep Learning", "Neural Networks", "CNN", "ResNet"
  ],
  "articleBody": "Introduction ResNet, which stands for Residual Network, is a revolutionary deep learning model created by Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun in their 2015 paper “Deep Residual Learning for Image Recognition.” ResNet tackles big challenges in training very deep neural networks, like the vanishing gradient problem, and has achieved amazing results in various computer vision tasks.\nWhy ResNet? The Need for Deeper Networks Traditional Convolutional Neural Networks (CNNs) face performance issues when the network depth increases. This isn’t because of overfitting but rather an optimization challenge where adding more layers makes the network harder to train effectively.\nThe Vanishing Gradient Problem It has been found that there is a maximum threshold for depth with the traditional CNN. When neural networks get deeper, the gradients used to update weights during backpropagation become very small, leading to negligible updates. This is known as the vanishing gradient problem and it makes training very deep networks difficult.\nThe Solution: Residual Blocks ResNet introduces residual learning through residual blocks. Instead of expecting each layer to directly fit a desired mapping, residual blocks allow layers to fit a residual mapping. It’s easier to optimize the residual mapping than the original, unreferenced mapping.\nResidual Block Structure A typical residual block in ResNet has two or more convolutional layers followed by batch normalization and ReLU activation. The input to the block is added directly to the output of the stacked layers (this addition is the “shortcut connection”), creating a residual connection.\nMathematical Representation If the input is $ ( x ) $ and the desired output is $( H(x) ) $, a residual block models this as: $\\ H(x) = F(x, {W_i}) + x $ where $ ( F(x, {W_i}) ) $ represents the residual mapping to be learned.\nResNet Architecture ResNet architectures come in various depths, such as ResNet-18, ResNet-34, ResNet-50, ResNet-101, and ResNet-152~201, indicating the number of layers. These architectures stack residual blocks to create deep networks that can effectively learn complex features.\nKey Components Convolutional Layers: Extract features from the input image. Batch Normalization: Normalizes the output of each convolutional layer, stabilizing and accelerating training. ReLU Activation: Introduces non-linearity. Residual Connections: Add the input of the block to the output, allowing the network to learn residual mappings. Achievements of ResNet ResNet won first place in the ILSVRC 2015 classification competition with a top-5 error rate of 3.57% using an ensemble model. It also won first place in the ImageNet Detection, ImageNet Localization, COCO Detection, and COCO Segmentation tasks in the ILSVRC and COCO 2015 competitions.\nNotably, replacing VGG-16 layers in Faster R-CNN with ResNet-101 layers led to a 28% relative improvement.\nTransfer Learning or Fine-tuning ResNet’s pre-trained models are often used for transfer learning, where a model trained on a large dataset like ImageNet is fine-tuned for specific tasks with smaller datasets.\nThis approach significantly reduces training time and improves performance.\n",
  "wordCount" : "479",
  "inLanguage": "en",
  "datePublished": "2024-03-22T18:34:44.165668+05:00",
  "dateModified": "2024-03-22T18:34:44.165668+05:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://adilsarsenov.dev/posts/resnet/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Adil's Notes",
    "logo": {
      "@type": "ImageObject",
      "url": "https://adilsarsenov.dev/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top"><script>
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true
    },
    svg: {
      fontCache: 'global'
    }
  };
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header sticky-header">
    <nav class="nav">
        <div class="logo">
            <a href="https://adilsarsenov.dev/" accesskey="h" title="Adil&#39;s Notes (Alt + H)">Adil&#39;s Notes</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://adilsarsenov.dev/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://adilsarsenov.dev/posts" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://adilsarsenov.dev/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://adilsarsenov.dev/search" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://adilsarsenov.dev/tags" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://adilsarsenov.dev/">Home</a>&nbsp;»&nbsp;<a href="https://adilsarsenov.dev/posts/">Posts</a></div>
    <h1 class="post-title">
      ResNet - Residual Blocks
    </h1>
    <div class="post-description">
      Dive into ResNet architecture and its innovative residual blocks.
    </div>
    <div class="post-meta">


Date: 22 March, 2024

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">‎ Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#introduction" aria-label="Introduction">Introduction</a></li>
                <li>
                    <a href="#why-resnet" aria-label="Why ResNet?">Why ResNet?</a><ul>
                        
                <li>
                    <a href="#the-need-for-deeper-networks" aria-label="The Need for Deeper Networks">The Need for Deeper Networks</a></li>
                <li>
                    <a href="#the-vanishing-gradient-problem" aria-label="The Vanishing Gradient Problem">The Vanishing Gradient Problem</a></li></ul>
                </li>
                <li>
                    <a href="#the-solution-residual-blocks" aria-label="The Solution: Residual Blocks">The Solution: Residual Blocks</a><ul>
                        
                <li>
                    <a href="#residual-block-structure" aria-label="Residual Block Structure">Residual Block Structure</a></li>
                <li>
                    <a href="#mathematical-representation" aria-label="Mathematical Representation">Mathematical Representation</a></li></ul>
                </li>
                <li>
                    <a href="#resnet-architecture" aria-label="ResNet Architecture">ResNet Architecture</a><ul>
                        
                <li>
                    <a href="#key-components" aria-label="Key Components">Key Components</a></li></ul>
                </li>
                <li>
                    <a href="#achievements-of-resnet" aria-label="Achievements of ResNet">Achievements of ResNet</a></li>
                <li>
                    <a href="#transfer-learning-or-fine-tuning" aria-label="Transfer Learning or Fine-tuning">Transfer Learning or Fine-tuning</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h3 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h3>
<p>ResNet, which stands for Residual Network, is a revolutionary deep learning model created by
<strong>Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun in their 2015 paper &ldquo;Deep Residual Learning for Image Recognition.&rdquo;</strong>
ResNet tackles big challenges in training very deep neural networks, like the vanishing gradient problem,
and has achieved amazing results in various computer vision tasks.</p>
<h3 id="why-resnet">Why ResNet?<a hidden class="anchor" aria-hidden="true" href="#why-resnet">#</a></h3>
<h4 id="the-need-for-deeper-networks">The Need for Deeper Networks<a hidden class="anchor" aria-hidden="true" href="#the-need-for-deeper-networks">#</a></h4>
<p>Traditional Convolutional Neural Networks (CNNs) face performance issues when the network depth increases.
This <strong>isn&rsquo;t because of overfitting</strong> but rather an optimization challenge where adding more layers makes the network harder to train effectively.</p>
<h4 id="the-vanishing-gradient-problem">The Vanishing Gradient Problem<a hidden class="anchor" aria-hidden="true" href="#the-vanishing-gradient-problem">#</a></h4>
<p>It has been found that there is a <strong>maximum threshold</strong> for depth with the <strong>traditional CNN</strong>.
When neural networks get deeper, the gradients used to <strong>update weights during backpropagation</strong> become very small,
leading to negligible updates. This is known as the <strong>vanishing gradient problem</strong> and it makes training very deep networks difficult.</p>
<p><img loading="lazy" src="/posts/resnet/img2.png" alt="Vanishing"  />
</p>
<h3 id="the-solution-residual-blocks">The Solution: Residual Blocks<a hidden class="anchor" aria-hidden="true" href="#the-solution-residual-blocks">#</a></h3>
<p><strong>ResNet</strong> introduces residual learning through residual blocks. Instead of expecting each layer to directly fit a desired mapping,
residual blocks allow layers to fit a residual mapping. <strong>It&rsquo;s easier to optimize the residual mapping</strong> than the original, unreferenced mapping.</p>
<h4 id="residual-block-structure">Residual Block Structure<a hidden class="anchor" aria-hidden="true" href="#residual-block-structure">#</a></h4>
<p>A typical residual block in ResNet has two or more convolutional layers followed by batch normalization and ReLU activation.
<strong>The input to the block is added directly to the output of the stacked layers (this addition is the &ldquo;shortcut connection&rdquo;),
creating a residual connection.</strong></p>
<h4 id="mathematical-representation">Mathematical Representation<a hidden class="anchor" aria-hidden="true" href="#mathematical-representation">#</a></h4>
<p>If the input is $ ( x ) $ and the desired output is $( H(x) ) $, a residual block models this as:
$\ H(x) = F(x, {W_i}) + x $
where $ ( F(x, {W_i}) ) $ represents the residual mapping to be learned.</p>
<p><img loading="lazy" src="/posts/resnet/img1.png" alt="ResNet"  />
</p>
<h3 id="resnet-architecture">ResNet Architecture<a hidden class="anchor" aria-hidden="true" href="#resnet-architecture">#</a></h3>
<p>ResNet architectures come in various depths, such as <strong>ResNet-18, ResNet-34, ResNet-50, ResNet-101, and ResNet-152~201</strong>, indicating the number of layers. These architectures stack residual blocks to create deep networks that can effectively learn complex features.</p>
<h4 id="key-components">Key Components<a hidden class="anchor" aria-hidden="true" href="#key-components">#</a></h4>
<ul>
<li><strong>Convolutional Layers:</strong> Extract features from the input image.</li>
<li><strong>Batch Normalization:</strong> Normalizes the output of each convolutional layer, stabilizing and accelerating training.</li>
<li><strong>ReLU Activation:</strong> Introduces non-linearity.</li>
<li><strong>Residual Connections:</strong> Add the input of the block to the output, allowing the network to learn residual mappings.</li>
</ul>
<p><img loading="lazy" src="/posts/resnet/img3.png" alt="ResNetExample"  />
</p>
<h3 id="achievements-of-resnet">Achievements of ResNet<a hidden class="anchor" aria-hidden="true" href="#achievements-of-resnet">#</a></h3>
<p>ResNet <strong>won first place</strong> in the <strong>ILSVRC 2015 classification competition</strong> with a top-5 error rate of 3.57% using an ensemble model.
It also <strong>won first place in the ImageNet Detection, ImageNet Localization, COCO Detection, and COCO Segmentation tasks
in the ILSVRC and COCO 2015 competitions</strong>.</p>
<p>Notably, replacing VGG-16 layers in Faster R-CNN with ResNet-101 layers led to a 28% relative improvement.</p>
<h3 id="transfer-learning-or-fine-tuning">Transfer Learning or Fine-tuning<a hidden class="anchor" aria-hidden="true" href="#transfer-learning-or-fine-tuning">#</a></h3>
<p>ResNet&rsquo;s pre-trained models are often used for <strong>transfer learning</strong>, where a model trained on a <strong>large dataset like
ImageNet</strong> is fine-tuned for specific tasks with smaller datasets.</p>
<p>This approach <strong>significantly reduces training time</strong> and improves performance.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://adilsarsenov.dev/tags/deep-learning/">Deep Learning</a></li>
      <li><a href="https://adilsarsenov.dev/tags/neural-networks/">Neural Networks</a></li>
      <li><a href="https://adilsarsenov.dev/tags/cnn/">CNN</a></li>
      <li><a href="https://adilsarsenov.dev/tags/resnet/">ResNet</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://adilsarsenov.dev/">Adil&#39;s Notes</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
